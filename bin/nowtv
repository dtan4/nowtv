#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path("../../lib", __FILE__)

require 'nowtv'

CONFIGURE_PATH = ENV["HOME"] + '/.nowtv'

region_code =
  File.exists?(CONFIGURE_PATH) ? open(CONFIGURE_PATH).read.lines[0].strip : 'tokyo'

if ARGV.length > 1
  $stderr.puts 'Too many arguments.'
elsif ARGV.length == 1
  region_code = ARGV[0]
end

client = Nowtv::Client.new
programs = client.get_program_list(region_code)

programs.each do |program|
  puts "#{program[:station]} = #{program[:title]} [#{program[:start_time]} -> #{program[:end_time]}]"
end if programs
